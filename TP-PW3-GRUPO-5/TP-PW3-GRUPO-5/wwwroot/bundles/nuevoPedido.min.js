function AgregarArticulo(){let t=document.getElementById("articulo").value,r=document.getElementById("articulo"),i=r.options[r.selectedIndex].text;i=i.split("#")[0];let n=Number.parseInt(document.getElementById("cantidad").value);if(t==""||Number.isNaN(n))$("#errorSelect").html("Debe seleccionar un articulo y una cantidad.");else{let r={Codigo:t,Descripcion:i,Cantidad:n};if(articulos.length!=0){let i=articulos.findIndex(n=>n.Codigo==t);if(i!=-1){let n=articulos[i],t=n.Cantidad;r.Cantidad+=t;articulos.splice(i,1);r.Cantidad>0&&(articulos.push(r),$("#errorSelect").html(""));articulos.sort(Compare);CargarTabla(articulos)}else n>0?(articulos.push(r),$("#errorSelect").html("")):$("#errorSelect").html("Ingrese una cantidad valida"),articulos.sort(Compare),CargarTabla(articulos)}else n>0?(articulos.push(r),$("#errorSelect").html("")):$("#errorSelect").html("Ingrese una cantidad valida"),articulos.sort(Compare),CargarTabla(articulos)}}function Compare(n,t){return n.Codigo>t.Codigo?1:n.Codigo<t.Codigo?-1:0}function CargarTabla(n){if(listado="",n.length==0)listado=`<tr class="text-center">
                   <td colspan = "4" >No se cargaron articulos</td >
                   </tr >`;else{let t=0;n.forEach(n=>{listado+=`<tr><td>
                ${n.Descripcion}
                </td>
                <td>
                ${n.Codigo}
                </td>
                <td>
                ${n.Cantidad}
                </td>
                <td>
                <a onclick="quitarArticulo(${t})">Quitar</a>
                </td>                  
        </tr>`,t++})}$("#tbody").html(listado)}function MandarForm(n){let t=document.getElementById("cliente"),i=Number.parseInt(t.value);if(articulos.length>0&&!Number.isNaN(i)){let i=t.options[t.selectedIndex].text;i=i.split("#")[0];let r={IdCliente:document.getElementById("cliente").value,Articulos:articulos,Accion:n,Comentarios:document.getElementById("comentarios").value};fetch("https://localhost:44344/Pedido/NuevoPedido",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(r)}).then(n=>n.json()).then(n=>{n.Accion=="guardar"&&(window.location.href="/Pedido/Index"),MostrarMensaje(n.Mensaje,i),ResetForm()})}else $("#errorSelect").html("Debe seleccionar un cliente y al menos un articulo.")}function MostrarMensaje(n,t){let i=`<div class="alert alert-success alert-dismissible "><label>Pedido de ${t} nro. 123 creado con exito</label>
        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    </div>`;$("#alert").html(i)}function ResetForm(){articulos=[];document.getElementById("cliente").selectedIndex=0;document.getElementById("articulo").selectedIndex=0;$(".select2NuevoPedido").select2();document.getElementById("cantidad").value="";document.getElementById("comentarios").value="";$("#errorSelect").html("");CargarTabla(articulos)}function quitarArticulo(n){articulos.splice(n,1);articulos.sort(Compare);CargarTabla(articulos)}var articulos=[];$(document).ready(function(){$(".select2NuevoPedido").select2()});$(document).ready(function(){$(".alert").hide();CargarTabla(articulos)});